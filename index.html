
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>JavaScript Data Visualizations</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.2/papaparse.min.js"></script>
    <style>
        canvas { max-width: 800px; margin: 30px auto; display: block; }
        body { font-family: Arial, sans-serif; padding: 20px; }
    </style>
</head>
<body>
<h2>JavaScript Visualization Homework - Rishitha Erupaka [#1030375]</h2>

<canvas id="chartCars"></canvas>
<canvas id="chartFunds"></canvas>
<canvas id="chartFilms"></canvas>
<canvas id="chartGrocery"></canvas>
<canvas id="chartCereals"></canvas>

<script>
// Load and process CSV data using PapaParse
function loadCSV(url, callback) {
    Papa.parse(url, {
        download: true,
        header: true,
        complete: function(results) {
            callback(results.data);
        }
    });
}

// Cars Visualization
loadCSV('cars.csv', function(data) {
    const regions = {};
    data.forEach(row => {
        const origin = row['Origin'];
        const hp = parseFloat(row['Horsepower']);
        if (!isNaN(hp)) {
            if (!regions[origin]) regions[origin] = [];
            regions[origin].push(hp);
        }
    });
    const labels = Object.keys(regions);
    const values = labels.map(r => regions[r].reduce((a,b)=>a+b)/regions[r].length);

    new Chart(document.getElementById('chartCars'), {
        type: 'bar',
        data: {
            labels: labels,
            datasets: [{
                label: 'Average Horsepower by Origin',
                data: values,
                backgroundColor: 'rgba(54, 162, 235, 0.6)'
            }]
        }
    });
});

// Mutual Funds Visualization
loadCSV('mutualfunds.csv', function(data) {
    const labels = data.map(row => row['Category']);
    const ytd = data.map(row => parseFloat(row['YTD']));
    const yr5 = data.map(row => parseFloat(row['5YR']));
    const yr10 = data.map(row => parseFloat(row['10YR']));

    new Chart(document.getElementById('chartFunds'), {
        type: 'bar',
        data: {
            labels: labels,
            datasets: [
                { label: 'YTD', data: ytd, backgroundColor: 'rgba(255, 99, 132, 0.6)' },
                { label: '5YR', data: yr5, backgroundColor: 'rgba(255, 206, 86, 0.6)' },
                { label: '10YR', data: yr10, backgroundColor: 'rgba(75, 192, 192, 0.6)' }
            ]
        },
        options: { responsive: true }
    });
});

// Films Visualization
loadCSV('film.csv', function(data) {
    const x = [], y = [], bg = [];
    data.forEach(row => {
        const len = parseFloat(row['Length']);
        const pop = parseFloat(row['Popularity']);
        if (!isNaN(len) && !isNaN(pop)) {
            x.push(len);
            y.push(pop);
            bg.push(row['Awards'] === 'Yes' ? 'rgba(0,200,0,0.7)' : 'rgba(200,0,0,0.7)');
        }
    });
    new Chart(document.getElementById('chartFilms'), {
        type: 'scatter',
        data: {
            datasets: [{
                label: 'Film Length vs Popularity',
                data: x.map((v, i) => ({ x: v, y: y[i] })),
                backgroundColor: bg
            }]
        },
        options: {
            scales: {
                x: { title: { display: true, text: 'Film Length (min)' } },
                y: { title: { display: true, text: 'Popularity' } }
            }
        }
    });
});

// Grocery Store Survey Visualization
loadCSV('grocerystoresurvey.csv', function(data) {
    const methods = {};
    data.forEach(row => {
        const method = row['PaymentMethod'];
        const amt = parseFloat(row['PurchaseAmount']);
        if (!isNaN(amt)) {
            if (!methods[method]) methods[method] = [];
            methods[method].push(amt);
        }
    });
    const labels = Object.keys(methods);
    const values = labels.map(k => methods[k].reduce((a,b)=>a+b)/methods[k].length);

    new Chart(document.getElementById('chartGrocery'), {
        type: 'bar',
        data: {
            labels: labels,
            datasets: [{
                label: 'Avg Purchase by Payment Method',
                data: values,
                backgroundColor: 'rgba(153, 102, 255, 0.6)'
            }]
        }
    });
});

// Cereals Visualization
loadCSV('cereals.csv', function(data) {
    const cereals = data.map(row => row['Cereal']);
    const sugar = data.map(row => parseFloat(row['Sugars']));
    const protein = data.map(row => parseFloat(row['Protein']));

    new Chart(document.getElementById('chartCereals'), {
        type: 'bubble',
        data: {
            datasets: cereals.map((c, i) => ({
                label: c,
                data: [{ x: sugar[i], y: protein[i], r: 5 }],
                backgroundColor: 'rgba(255, 159, 64, 0.6)'
            }))
        },
        options: {
            plugins: { legend: { display: false } },
            scales: {
                x: { title: { display: true, text: 'Sugar' } },
                y: { title: { display: true, text: 'Protein' } }
            }
        }
    });
});
</script>

</body>
</html>
